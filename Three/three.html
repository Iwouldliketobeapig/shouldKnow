<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>球体</title>
    <script src = '../js/three.js'></script>
</head>
<style type="text/css">
    #ball{
        width: 100%;
        height: 1000px;
    }
</style>
<body>
<div id = "ball"></div>
</body>
<script>

    //场景
    var scene;
    function initScene(){
        scene = new THREE.Scene();
    }

    //渲染器
    var renderer;
    function initRenderer(){
        w = document.getElementById('ball').clientWidth;
        h = document.getElementById('ball').clientHeight;
        renderer = new THREE.WebGLRenderer();
        renderer.setSize(w, h);
        document.getElementById('ball').appendChild(renderer.domElement);
        renderer.setClearColor(0x000000, 1.0);
    }

    //相机
    var camera;
    function initCamera(){
        camera = new THREE.PerspectiveCamera(45, w / h, 1, 1000);
        camera.position.set(0, 0, 150);
        camera.lookAt({
            x: 0,
            y: 0,
            z: 0
        })
    }

    //光源
    var light;
    function initLight(){
        light = new THREE.AmbientLight(0xffffff);
        light.position.set(100, 100, 200);
        scene.add(light);
    }

    //物体
    var eathMesh,
        moonMesh,
        sunMesh,
        sunPivotePoint,
        eathPivotePoint;
    function initCube(){

        //假装这个是太阳
        sunMesh = new THREE.Mesh(
            new THREE.SphereGeometry(10),
            new THREE.MeshBasicMaterial({
                color: 0xff0000,
                wireframe: true
            })
        );
        sunMesh.position.set(0, 0, 0);
        scene.add(sunMesh);
        sunPivotePoint = new THREE.Object3D();
        sunMesh.add(sunPivotePoint);

        //假装这个是地球
        eathMesh = new THREE.Mesh(
            new THREE.SphereGeometry(4),
            new THREE.MeshBasicMaterial({
                color: 0xff0000,
                wireframe: true
            })
        );
        eathMesh.position.set(60, 0, 0);
        scene.add(eathMesh);
        eathPivotePoint = new THREE.Object3D();
        eathMesh.add(eathPivotePoint);
        sunPivotePoint.add(eathMesh)

        //假装你是月亮了
        moonMesh = new THREE.Mesh(
            new THREE.SphereGeometry(2),
            new THREE.MeshBasicMaterial({
                color: 0xff0000,
                wireframe: true,
            })
        );
        moonMesh.position.set(10, 0, 0);
        scene.add(moonMesh);
        eathPivotePoint.add(moonMesh)
    }

    //绘制星星
    function starts(num){
        for(var i = 0; i < num; i++){
            let meshs = new THREE.Mesh(
                new THREE.SphereGeometry(0.1),
                new THREE.MeshBasicMaterial({
                    color: 0xffffff
                })
            );
            let a = [];
            for(var j = 0; j < 3; j++){
                let position = Math.ceil(Math.random()*4000 - 2000);
                a.push(position);
            };
            let x = Math.ceil(Math.random()*400 - 200);
            let y = Math.ceil(Math.random()*400 - 200);
            let z = Math.ceil(Math.random()*5);
            meshs.position.set(x, y, z);
            scene.add(meshs);
        }
    }

    //执行
    function threeDo(){
        initScene();
        initRenderer();
        initLight();
        initCamera();
        initCube();
        starts(1000);
        MaxAnimation();
    }

    //运动
    function MaxAnimation(){
        eathMesh.rotation.z = (eathMesh.rotation.z + 0.01) % (Math.PI * 2);
        moonMesh.rotation.y = (moonMesh.rotation.y + 0.01) % (Math.PI * 2)
        sunPivotePoint.rotation.z = (sunPivotePoint.rotation.z + 0.01) % (Math.PI * 2);
        eathPivotePoint.rotation.z = (eathPivotePoint.rotation.z + 0.05) % (Math.PI * 2);

        renderer.render(scene, camera);
        requestAnimationFrame(MaxAnimation);
    }
    window.onload = threeDo();

     
</script>
</html>